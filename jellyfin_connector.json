{
  "id": "jellyfin",
  "name": "Jellyfin Connector",
  "version": "2025-11-23-004",
  "description": "Konektor pro přístup k Jellyfin API",
  "media": ["movies", "series"],
  "type": ["catalogues", "details", "stream"],
  "website": "https://github.com/klucon/jellyfin_connector",

  "baseUrl": "http://{server}",

  "responseFormat": "json",

  "config": {
    "server": {
      "type": "string",
      "label": "Jellyfin Server (IP/URL)",
      "placeholder": "192.168.0.100:8096",
      "required": true
    },
    "username": {
      "type": "string",
      "label": "Uživatelské jméno",
      "required": true
    },
    "password": {
      "type": "string",
      "label": "Heslo",
      "required": true
    }
  },

  "headers": {
    "X-Emby-Authorization": "MediaBrowser Client=\"Streamlet\", Device=\"Streamlet\", DeviceId=\"streamlet01\", Version=\"1.0.0\""
  },

  "auth": {
    "type": "dynamic",
    "method": "POST",
    "url": "/Users/AuthenticateByName",
    "payload": {
      "Username": "{username}",
      "Pw": "{password}"
    },
    "response": {
      "mapping": {
        "apiKey": "AccessToken",
        "userId": "User.Id"
      }
    },
    "save": ["apiKey", "userId"]
  },

  "api": [

    /* =====================
       MOVIES - catalogue
    ====================== */
    {
      "name": "{movies}",
      "type": "catalogue_movies",
      "mediaType": "movie",
      "isHome": true,
      "method": "GET",
      "url": "/Users/{userId}/Items?IncludeItemTypes=Movie&Recursive=true&StartIndex={offset}&Limit=40&api_key={apiKey}",
      "responseFormat": "json",
      "response": {
        "itemsKey": "Items",
        "mapping": {
          "id": "Id",
          "title": "Name",
          "rating": "CommunityRating",
          "poster": "Id"
        }
      },
      "imageBaseUrl": "http://{server}/Items/{id}/Images/Primary?api_key={apiKey}"
    },

    /* =====================
       SERIES - catalogue
    ====================== */
    {
      "name": "{series}",
      "type": "catalogue_series",
      "mediaType": "series",
      "isHome": true,
      "method": "GET",
      "url": "/Users/{userId}/Items?IncludeItemTypes=Series&Recursive=true&StartIndex={offset}&Limit=40&api_key={apiKey}",
      "responseFormat": "json",
      "response": {
        "itemsKey": "Items",
        "mapping": {
          "id": "Id",
          "title": "Name",
          "rating": "CommunityRating",
          "poster": "Id"
        }
      },
      "imageBaseUrl": "http://{server}/Items/{id}/Images/Primary?api_key={apiKey}"
    },

    /* =====================
       MOVIE DETAIL
    ====================== */
    {
      "type": "movie_detail",
      "method": "GET",
      "url": "/Items/{id}?api_key={apiKey}",
      "responseFormat": "json",
      "response": {
        "mapping": {
          "id": "Id",
          "title": "Name",
          "overview": "Overview",
          "tagline": "Taglines[0]",
          "posterPath": "Id",
          "backdropPath": "BackdropImageTags[0]",
          "rating": "CommunityRating",
          "genres": "Genres",
          "releaseDate": "PremiereDate",
          "runtime": "RunTimeTicks"
        }
      },
      "posterBaseUrl": "http://{server}/Items/{id}/Images/Primary?api_key={apiKey}",
      "backdropBaseUrl": "http://{server}/Items/{id}/Images/Backdrop?api_key={apiKey}"
    },

    /* =====================
       SERIES DETAIL
    ====================== */
    {
      "type": "series_detail",
      "method": "GET",
      "url": "/Items/{id}?api_key={apiKey}",
      "responseFormat": "json",
      "response": {
        "mapping": {
          "id": "Id",
          "title": "Name",
          "overview": "Overview",
          "posterPath": "Id",
          "backdropPath": "BackdropImageTags[0]",
          "rating": "CommunityRating",
          "genres": "Genres",
          "numberOfSeasons": "SeasonCount"
        }
      },
      "posterBaseUrl": "http://{server}/Items/{id}/Images/Primary?api_key={apiKey}",
      "backdropBaseUrl": "http://{server}/Items/{id}/Images/Backdrop?api_key={apiKey}"
    },

    /* =====================
       EPISODES
    ====================== */
    {
      "type": "series_episodes_detail",
      "method": "GET",
      "url": "/Shows/{series_id}/Seasons/{season_number}?UserId={userId}&api_key={apiKey}",
      "responseFormat": "json",
      "response": {
        "itemsKey": "Items",
        "episodeMapping": {
          "id": "Id",
          "name": "Name",
          "overview": "Overview",
          "airDate": "PremiereDate",
          "episodeNumber": "IndexNumber",
          "seasonNumber": "ParentIndexNumber",
          "stillPath": "Id",
          "rating": "CommunityRating"
        }
      },
      "imageBaseUrl": "http://{server}/Items/{id}/Images/Primary?api_key={apiKey}"
    },

    /* =====================
       SEARCH MOVIES
    ====================== */
    {
      "name": "{searchMovies}",
      "type": "search_movies",
      "mediaType": "movie",
      "method": "GET",
      "url": "/Search/Hints?SearchTerm={query}&IncludeItemTypes=Movie&UserId={userId}&api_key={apiKey}",
      "responseFormat": "json",
      "response": {
        "itemsKey": "SearchHints",
        "mapping": {
          "id": "ItemId",
          "title": "Name",
          "poster": "ItemId"
        }
      },
      "imageBaseUrl": "http://{server}/Items/{id}/Images/Primary?api_key={apiKey}"
    },

    /* =====================
       SEARCH SERIES
    ====================== */
    {
      "name": "{searchSeries}",
      "type": "search_series",
      "mediaType": "series",
      "method": "GET",
      "url": "/Search/Hints?SearchTerm={query}&IncludeItemTypes=Series&UserId={userId}&api_key={apiKey}",
      "responseFormat": "json",
      "response": {
        "itemsKey": "SearchHints",
        "mapping": {
          "id": "ItemId",
          "title": "Name",
          "poster": "ItemId"
        }
      },
      "imageBaseUrl": "http://{server}/Items/{id}/Images/Primary?api_key={apiKey}"
    },

    /* =====================
       STREAM LINK
    ====================== */
    {
      "name": "link",
      "type": "link",
      "method": "GET",
      "url": "/Videos/{id}/stream?api_key={apiKey}",
      "responseFormat": "json",
      "response": {
        "mapping": {
          "link": "Url"
        }
      }
    }
  ]
}
